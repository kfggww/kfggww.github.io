<!DOCTYPE html>
<html lang="en">
  <head>
	<meta name="generator" content="Hugo 0.68.3" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content=""
  />
  
    
      <title>junan&#39;s blog</title>
    
  
  <link rel="stylesheet" href="/css/reset.css"/>
  <link rel="stylesheet" href="/css/font.css"/>
  <link rel="stylesheet" href="/css/smigle.css"/>
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
</head>

  <body>
    <header>
  <div id="brand">
    <a class="icon-link" href="http://kfggww.github.io/">
      <img
        class="icon"
        src="/images/brandIcon.svg"
      />
    </a>
    <div class="text">
      <a href="http://kfggww.github.io/"><h1>junan&#39;s blog</h1></a>
      <h3>What I cannot create I do not understand</h3>
    </div>
  </div>
  <nav>
    
  </nav>
  <hr />
</header>

    <div id="content">
      
	<main>
		
		
			<article>
  <h1 class="summary-title"><a href="http://kfggww.github.io/posts/xv6-debug/">Xv6 Debug</a></h1>
  <div class="post-meta">
  <strong>
    <span>Posted on</span>
    <time>2022-03-27 09:23:24</time>
    
    
  </strong>
  <span> • 77 words</span>
  <span> • 1 minute read</span>
  
</div>

  <div class="summary-body">
    <p>1. 概述 xv6是MIT6.S081操作系统课程使用的一个教学性质的OS, 提供了针对OS不同模块的实验. 本文仅讨论支持RISC-V指令集的xv6, 调试xv6内核代码使用qemu + gdb的方式, xv6的代码使用RISC-V汇编和c语言编写, 整个工程的构建使用Makefile管理, 并且使用链接脚本控制kernel文件的链接过程, 因此, 为了能够顺利完成之后的代码实验, 需要掌握的前置知识包括但不限于:
 RISC-V指令集. 非特权指令, 特权指令, trap, plic, &hellip; c语言基础. qemu仿真器. 启动/退出, 关键启动参数的作用 gdb基本调试. 断点, 查看变量/内存/寄存器, gdb脚本, 执行流控制, 多线程程序debug, &hellip; gnu make工具. 链接脚本基本概念. 完成实验不必自己写链接脚本, 但对于理解kernel文件在内存中布局很有帮助.  当然, 不必在精通了全部上述所列内容之后再开始对xv6的学习. 对一些知识先有一个大概的了解即可, 如果在完成实验时遇到了阻碍再去专门仔细研究, 可能反而会理解得更深入一些.
2. 环境准备 3. 调试xv6 使用qemu启动xv6之后, init进程会fork出一个shell进程, 当用户通过终端输入字符时, 输入的字符会回显出来, 输入结束敲击回车, shell进程会解析并执行用户输入的命令, 接下来就使用gdb+qemu对这个过程进行调试.
 首先, 启动一个终端, 并启动qemu等待gdb连接. 开启另一个终端, 使用gdb连接qemu. xv6内核完成初始化之后会跳转到第一个用户进程init, init进程首先尝试打开&quot;console&quot;文件, 若文件不存在则创建一个并打开, 这个打开的&quot;console&quot;文件在init进程中的文件描述符为0, 之后发起两次dup调用, 此时init进程中打开的文件描述符有0, 1, 2, 并且都指向&quot;console&quot;文件. 接下来init进程会fork出shell进程, shell进程负责解析并执行用户命令, init进程则一直等待fork出的shell进程退出, shell进程的文件描述符0, 1, 2继承自init进程.</p>
    
      <a href="http://kfggww.github.io/posts/xv6-debug/">Read more...</a>
    
  </div>
</article>

		
			<article>
  <h1 class="summary-title"><a href="http://kfggww.github.io/posts/todo/">TODOs</a></h1>
  <div class="post-meta">
  <strong>
    <span>Posted on</span>
    <time>2022-03-22 14:03:17</time>
    
    
  </strong>
  <span> • 83 words</span>
  <span> • 1 minute read</span>
  
</div>

  <div class="summary-body">
    <p>3/25 - 4/2  xv6代码总结  基本环境搭建  riscv gcc qemu make git   调试常用技巧  断点 调用栈 寄存器查看 变量查看 用户代码和内核代码的调试 gdb脚本   各个lab总结 对xv6中不同模块代码的理解  进程 内存 文件系统 锁 riscv处理trap的过程 驱动代码   发布blog  小程序 公众号       Important Things  xv6  代码总结 os theory 在sifive的board上实现一个microkernel   ros  ros concepts ros tools rclcpp, rclpy ros development with gazebo ros development on hardware   arm board  basic circuit 数电/模电 EDA tools arm isa using arm board do something interesting  基于现有的传感器 提供的示例教程和代码     算法 + 数学  basic data structures and algorithms  everyday work, 总结算法题目 or 研究新题目 or 总结实现经典数据结构和算法   math    </p>
    
  </div>
</article>

		
		<div>
  
  1 of 1
  
</div>

	</main>

    </div>
    <footer>
  <hr />
  
  <p class="copyright">
    Copyright © 2022
    <a href="http://kfggww.github.io/"><strong>Blog Author</strong></a>.
    This work is licensed under the
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> license.
  </p>
  <p class="builtWith">
    Built with
    <a href="http://www.gohugo.io/">Hugo</a>,
    using the theme
    <a href="https://gitlab.com/ian-s-mcb/smigle-hugo-theme">smigle</a>,
    which was influenced by the theme
    <a href="https://github.com/sumnerevans/smol">smol</a>.
  </p>
</footer>

  </body>
</html>
